<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BoardDAO">
<!-- <resultMap type="board" id="boardMap">
	<id column="qb_id" property="qb_id"/>
	<result column="TITLE" property="board_title"/>
	<result column="m_id" property="m_id"/>
	<result column="CONTENT" property="content"/>
	<result column="REGDATE" property="regdate"/>
	<result column="CNT" property="cnt"/>
</resultMap> -->

<!--  map.put(key, value)  -->
<select id="getBoardListMap"  resultType="map" >
 SELECT  qb_id     "qb_id" ,
		 qb_title   "qb_title",
		 m_id  "m_id",
		 qb_content "qb_content",
		 qb_date "qb_date",
		 qb_hit     "qb_hit"  
   FROM  qna_board
  ORDER  BY qb_id DESC
</select>





<select id="getBoardList"  resultType="qnaboard" >
select b.*  from ( select a.*, rownum rn  from(
	 select
		    qb_id,
		    qb_title,
		    qb_content,
		    m_id,
		    qb_date
	   from  qna_board
	   <where>
	   	<if test="keyword != null and keyword != '' ">
	   		<if test="searchCondition == 'qb_title '">
	   			and qb_title like '%' || #{keyword}  || '%'
	   		</if>
	   		<if test="searchCondition == 'qb_content'">
	   			and qb_content like '%' || #{keyword}  || '%'
	   		</if>   		
	   	</if>
	   </where>
	  ORDER  BY qb_id DESC
) a  ) b where rn between #{start} and #{end} 	  
</select>


<select id="getBoardList2"  resultType="qnaboard" >
select b.*  from ( select a.*, rownum rn  from(
	 select
		    qb_id,
		    qb_title,
		    qb_content,
		    m_id,
		    qb_date
	   from  qna_board
	   <where>
	   	<if test="keyword != null and keyword != '' ">
	   		<if test="searchCondition == 'qb_title '">
	   			and qb_title like '%' || #{keyword}  || '%'
	   		</if>
	   		<if test="searchCondition == 'qb_content'">
	   			and qb_content like '%' || #{keyword}  || '%'
	   		</if>   		
	   	</if>
	   </where>
	  ORDER  BY qb_id DESC
) a  ) b where rn between #{start} and #{end} 	  
</select>



<!-- 전체 건수 -->
<select id="getBoardCount" resultType="int" >
	SELECT COUNT(*) 
	  FROM QNA_BOARD
	   <where>
	   	<if test="keyword != null and keyword != '' ">
	   		<if test="searchCondition == 'qb_title'">
	   			and qb_title like '%' || #{keyword}  || '%'
	   		</if>
	   		<if test="searchCondition == 'qb_content'">
	   			and qb_content like '%' || #{keyword}  || '%'
	   		</if>   		
	   	</if>
	   </where>	  
</select>



<delete id="deleteBoard" parameterType="qnaboard">
	DELETE qna_board 
	 WHERE qb_id = #{qb_id}
</delete>




<insert id="insertBoard">
	<selectKey order="BEFORE" resultType="int" keyProperty="qb_id">
		SELECT NVL(MAX(qb_id),0)+1 FROM qna_board		
	</selectKey>
	INSERT INTO qna_board(  qb_id,
						qb_title,
						m_id,
						qb_content,
						qb_hit
						  )
			   VALUES(  #{qb_id},
				        #{qb_title},
				        #{m_id},
				        #{qb_content},
					    0)		
</insert>



<update id="updateBoard" parameterType="qnaboard">
	UPDATE qna_board SET
		   qb_title   = #{qb_title},
		   qb_content = #{qb_content}
     WHERE qb_id =#{qb_id}
</update>




<!-- 단건조회 -->
<select id="getBoard" parameterType="qnaboard"  resultType="qnaboard" >
 SELECT  qb_id,
		 qb_title,
		 m_id,
		 qb_content,
		 qb_date,
		 qb_hit
   FROM  qna_board
  WHERE  qb_id = #{qb_id} 
</select>

</mapper>
