<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="SGroupDAO">

<!-- 은영 -->

	<!-- 방정보 한건 조회 -->
	<select id="getRoomInfo" parameterType="sgroup" resultType="sgroup">
		SELECT		SG_NUM,
					SG_NAME,
					SG_START_DTTM,
					SG_END_DTTM,
					SG_NOW_CNT,
					SG_END_CNT,
					SG_LOCATION,
					SG_XY,
					get_code_name(GENDER_CD) SPORTS1_CD,
					get_code_name(GENDER_CD) SKILL_CD,
					AGE_RANGE,
					get_code_name(GENDER_CD) GENDER_CD,
					get_code_name(STATUS_CD) STATUS_CD,
					SG_OPTION
		FROM 		SGROUP
		WHERE		SG_NUM = #{sg_num}
	</select>
	
	<!-- <update id="updateWhenJoin" parameterType="sgroup">
		UPDATE		SGROUP
		SET			SG_NOW_CNT = #{sg_now_cnt}
					<if test="searchCondition == 'title' ">
					STATUS_CD = ?
					</if>
		WHERE		SG_NUM = #{sg_num}
	
	</update> -->
	
	
	
	
	
	
	
<!-- ************ 미현 ********************* -->

<!-- 반짝 방 참여 전 인원수 1 증가시키는 맵퍼 -->
	<update id="updateCnt" parameterType="sgroup">
		UPDATE 	SGROUP
		SET		SG_NOW_CNT = #{sg_now_cnt}
		WHERE	SG_NUM = #{sg_num}
	</update>
	
<!-- SGroup 전체 조회 -->
	<select id="getSgList" resultType="sgroup">
		SELECT 
				SG_NUM,
				SG_NAME,
				SG_START_DTTM,
				SG_END_DTTM,
				SG_NOW_CNT,
				SG_END_CNT,
				SG_LOCATION,
				SG_XY,
				SPORTS1_CD,
				get_code_name(SKILL_CD) SKILL_CD,
				AGE_RANGE,
				get_code_name(GENDER_CD) GENDER_CD,
				get_code_name(STATUS_CD) STATUS_CD,
				SG_OPTION
		FROM	SGROUP
		ORDER BY 1
	</select>

<!-- SGroup 방 생성 + 활동 이력 추가 -->
	<select id="insertSg" statementType="CALLABLE" parameterType="sgroup">
		{ CALL sg_room_create(
			#{sg_name}
			,#{sg_end_dttm}
			,#{sg_end_cnt}
			,#{sg_location}
			,#{sg_xy}
			,#{sports1_cd}
			,#{skill_cd}
			,#{age_range}
			,#{gender_cd}
			,#{sg_option}
			,#{m_id}
			,#{sg_num, mode=OUT, jdbcType=NUMERIC, javaType=Integer }
		)}
	</select>

</mapper>